<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∂Ö‡∂≠‡∑ä ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∑Ñ‡∂≥‡∑î‡∂±‡∑è‡∂ú‡∑ê‡∂±‡∑ì‡∂∏ - Sinhala Handwriting Recognition</title>

    <!-- Traditional Sri Lankan Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        :root {
            /* Traditional Sri Lankan Color Palette - Kandyan Temple Art */

            /* Primary Colors - Saffron/Buddhist Robe Colors */
            --saffron-deep: #D35400;
            --saffron-bright: #E67E22;
            --saffron-light: #F39C12;
            --saffron-glow: rgba(211, 84, 0, 0.3);

            /* Secondary Colors - Temple Teal/Peacock Blue */
            --teal-deep: #16A085;
            --teal-bright: #1ABC9C;
            --teal-light: #48C9B0;
            --teal-glow: rgba(22, 160, 133, 0.3);

            /* Accent Colors - Temple Gold/Brass */
            --gold-deep: #B7950B;
            --gold-bright: #D4AF37;
            --gold-light: #F1C40F;
            --gold-metallic: linear-gradient(135deg, #D4AF37, #FFD700, #B8860B);
            --gold-glow: rgba(212, 175, 55, 0.4);

            /* Background Colors - Deep Temple/Palace Colors */
            --bg-primary: #1A1625;
            --bg-secondary: #2C1E3A;
            --bg-tertiary: #3D2B4F;
            --bg-glass: rgba(45, 30, 58, 0.85);
            --bg-glass-light: rgba(61, 43, 79, 0.6);

            /* Text Colors - Warm Tones */
            --text-primary-light: #FDF6E3;
            --text-secondary-light: #F5E6D3;
            --text-accent: #D4AF37;

            /* Status Colors */
            --success: #27AE60;
            --warning: #F39C12;
            --error: #E74C3C;

            /* Glass Effects */
            --glass-border: rgba(212, 175, 55, 0.3);
            --glass-shadow: 0 8px 32px rgba(26, 22, 37, 0.4);
            --glass-blur: blur(15px);

            /* Shadows & Glows */
            --shadow-soft: 0 4px 20px rgba(0, 0, 0, 0.15);
            --shadow-strong: 0 15px 50px rgba(0, 0, 0, 0.3);
            --glow-saffron: 0 0 30px var(--saffron-glow);
            --glow-gold: 0 0 25px var(--gold-glow);
            --glow-teal: 0 0 20px var(--teal-glow);

            /* Animations */
            --transition-smooth: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            --transition-bounce: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans Sinhala', 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, var(--bg-tertiary) 100%);
            color: var(--text-primary-light);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated Traditional Background with Liyawel Patterns */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 120%;
            height: 120%;
            background:
                radial-gradient(circle at 20% 30%, var(--saffron-glow) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, var(--teal-glow) 0%, transparent 40%),
                radial-gradient(circle at 60% 20%, var(--gold-glow) 0%, transparent 30%);
            animation: traditionalFlow 25s ease-in-out infinite;
            pointer-events: none;
            z-index: -2;
        }

        @keyframes traditionalFlow {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(-2%, -1%) rotate(1deg); }
            50% { transform: translate(1%, -2%) rotate(-0.5deg); }
            75% { transform: translate(-1%, 1%) rotate(0.5deg); }
        }

        /* Traditional Pattern Overlay */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 10c8 8 15 15 8 23 8 8 0 15-8 23-8-8-15-15-8-23-8-8 0-15 8-23z' fill='%23D4AF37' opacity='0.05'/%3E%3C/svg%3E");
            pointer-events: none;
            z-index: -1;
        }

        .app-container {
            min-height: 100vh;
            display: grid;
            grid-template-rows: auto 1fr auto;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        /* Header with Traditional Decorative Elements */
        .header {
            text-align: center;
            padding: 2rem 0 1.5rem;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 4px;
            background: var(--gold-metallic);
            border-radius: 2px;
            animation: headerGlow 4s ease-in-out infinite alternate;
        }

        @keyframes headerGlow {
            from { box-shadow: var(--glow-gold); }
            to { box-shadow: var(--glow-gold), 0 0 40px var(--gold-glow); }
        }

        /* Traditional Corner Ornaments */
        .header::after {
            content: '‚ùã ‚ùã ‚ùã';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            color: var(--gold-bright);
            font-size: 1.2rem;
            opacity: 0.7;
            letter-spacing: 1rem;
        }

        .app-title {
            font-size: clamp(2.2rem, 4vw, 3.8rem);
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--gold-bright), var(--saffron-bright), var(--gold-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 20px rgba(212, 175, 55, 0.3);
            animation: titleFloat 8s ease-in-out infinite;
            letter-spacing: 0.02em;
        }

        .app-title-en {
            font-family: 'Inter', sans-serif;
            font-size: clamp(1rem, 2vw, 1.3rem);
            font-weight: 400;
            color: var(--text-secondary-light);
            opacity: 0.9;
            margin-top: 0.25rem;
            letter-spacing: 0.05em;
        }

        @keyframes titleFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        /* Main Content Layout */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: 2.5rem;
            padding: 1rem 0;
            align-items: start;
        }

        /* Canvas Panel with Traditional Frame */
        .canvas-panel {
            background: var(--bg-glass);
            backdrop-filter: var(--glass-blur);
            border-radius: 24px;
            border: 2px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }

        .canvas-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gold-metallic);
            opacity: 0.8;
        }

        .canvas-header {
            text-align: center;
            margin-bottom: 1.5rem;
            position: relative;
        }

        .canvas-title {
            font-size: 1.6rem;
            font-weight: 600;
            color: var(--gold-bright);
            margin-bottom: 0.25rem;
        }

        .canvas-title-en {
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            color: var(--text-secondary-light);
            opacity: 0.8;
        }

        /* Traditional Canvas Frame - Temple Window Style */
        .canvas-container {
            position: relative;
            margin: 2rem 0;
            border-radius: 20px;
            padding: 25px;
            background: linear-gradient(145deg, var(--bg-glass-light), var(--bg-glass));
            border: 3px solid var(--gold-bright);
            box-shadow:
                inset 0 3px 15px rgba(0, 0, 0, 0.2),
                0 10px 40px rgba(212, 175, 55, 0.15);
        }

        /* Traditional Corner Decorations - Temple Style */
        .canvas-container::before,
        .canvas-container::after {
            content: '';
            position: absolute;
            width: 40px;
            height: 40px;
            border: 3px solid var(--gold-bright);
            background: radial-gradient(circle, var(--gold-glow), transparent);
        }

        .canvas-container::before {
            top: 15px;
            left: 15px;
            border-right: none;
            border-bottom: none;
            border-radius: 12px 0 0 0;
        }

        .canvas-container::after {
            bottom: 15px;
            right: 15px;
            border-left: none;
            border-top: none;
            border-radius: 0 0 12px 0;
        }

        #drawingCanvas {
            width: 100%;
            max-width: 500px;
            height: 400px;
            background: linear-gradient(135deg, #FDF6E3, #F5E6D3);
            background-image:
                radial-gradient(circle at 25% 25%, rgba(212, 175, 55, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(211, 84, 0, 0.02) 0%, transparent 50%);
            border: 2px solid var(--teal-light);
            border-radius: 16px;
            box-shadow:
                inset 0 3px 15px rgba(0, 0, 0, 0.08),
                0 5px 25px rgba(0, 0, 0, 0.1);
            cursor: crosshair;
            display: block;
            margin: 0 auto;
            transition: var(--transition-smooth);
            position: relative;
        }

        #drawingCanvas:hover {
            transform: translateY(-3px);
            box-shadow:
                inset 0 3px 15px rgba(0, 0, 0, 0.08),
                0 8px 35px rgba(0, 0, 0, 0.15),
                var(--glow-teal);
        }

        #drawingCanvas:focus {
            outline: none;
            border-color: var(--saffron-bright);
            box-shadow:
                inset 0 3px 15px rgba(0, 0, 0, 0.08),
                var(--glow-saffron);
        }

        /* Canvas Info Badge with Traditional Style */
        .canvas-info {
            position: absolute;
            top: 35px;
            right: 35px;
            background: var(--bg-glass);
            backdrop-filter: var(--glass-blur);
            color: var(--text-primary-light);
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
            font-size: 0.8rem;
            font-family: 'Inter', monospace;
            border: 1px solid var(--glass-border);
            animation: fadeInRight 0.8s ease-out 0.5s both;
        }

        @keyframes fadeInRight {
            from { opacity: 0; transform: translateX(25px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Traditional Controls */
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1.2rem;
            justify-content: center;
            align-items: center;
            margin-top: 2rem;
        }

        .btn {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            gap: 0.4rem;
            padding: 1rem 1.8rem;
            border: none;
            border-radius: 20px;
            font-family: inherit;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-bounce);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            user-select: none;
            box-shadow: var(--shadow-soft);
            min-width: 120px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--saffron-deep), var(--saffron-bright));
            color: white;
            border: 2px solid var(--saffron-light);
        }

        .btn-primary:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: var(--shadow-strong), var(--glow-saffron);
            background: linear-gradient(135deg, var(--saffron-bright), var(--saffron-light));
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--teal-deep), var(--teal-bright));
            color: white;
            border: 2px solid var(--teal-light);
        }

        .btn-secondary:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: var(--shadow-strong), var(--glow-teal);
            background: linear-gradient(135deg, var(--teal-bright), var(--teal-light));
        }

        .btn-clear {
            background: linear-gradient(135deg, #E74C3C, #C0392B);
            color: white;
            border: 2px solid #EC7063;
        }

        .btn-clear:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: var(--shadow-strong), 0 0 25px rgba(231, 76, 60, 0.4);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn-text-si {
            font-weight: 600;
            font-size: 0.95rem;
        }

        .btn-text-en {
            font-family: 'Inter', sans-serif;
            font-size: 0.75rem;
            opacity: 0.9;
        }

        .btn i {
            font-size: 1.2rem;
            margin-bottom: 0.2rem;
        }

        /* Results Panel with Traditional Design */
        .results-panel {
            background: var(--bg-glass);
            backdrop-filter: var(--glass-blur);
            border-radius: 24px;
            border: 2px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            padding: 2rem;
            position: sticky;
            top: 1rem;
            max-height: calc(100vh - 2rem);
            overflow-y: auto;
        }

        .results-panel::-webkit-scrollbar {
            width: 8px;
        }

        .results-panel::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 4px;
        }

        .results-panel::-webkit-scrollbar-thumb {
            background: var(--gold-bright);
            border-radius: 4px;
        }

        .results-panel::-webkit-scrollbar-thumb:hover {
            background: var(--gold-light);
        }

        .results-header {
            text-align: center;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--glass-border);
            padding-bottom: 1rem;
            position: relative;
        }

        .results-header::after {
            content: '‚ùã';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-glass);
            color: var(--gold-bright);
            padding: 0 1rem;
            font-size: 1rem;
        }

        .results-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--gold-bright);
            margin-bottom: 0.25rem;
        }

        .results-title-en {
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            color: var(--text-secondary-light);
            opacity: 0.8;
        }

        /* Status Messages with Traditional Style */
        .status {
            padding: 1.2rem 1.5rem;
            border-radius: 18px;
            margin-bottom: 1.5rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 1rem;
            animation: slideIn 0.4s ease-out;
            border-left: 4px solid;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-25px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .status.loading {
            background: linear-gradient(135deg, rgba(243, 156, 18, 0.25), rgba(230, 126, 34, 0.15));
            color: var(--warning);
            border-left-color: var(--warning);
        }

        .status.success {
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.25), rgba(46, 204, 113, 0.15));
            color: var(--success);
            border-left-color: var(--success);
        }

        .status.error {
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.25), rgba(192, 57, 43, 0.15));
            color: var(--error);
            border-left-color: var(--error);
        }

        .loading-spinner {
            width: 24px;
            height: 24px;
            border: 3px solid transparent;
            border-top: 3px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Prediction Results with Traditional Cards */
        .predictions-container {
            margin-top: 1rem;
        }

        .prediction-item {
            background: linear-gradient(135deg, var(--bg-glass-light), var(--bg-glass));
            border: 2px solid var(--glass-border);
            border-radius: 20px;
            padding: 1.8rem;
            margin-bottom: 1.2rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            transition: var(--transition-smooth);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .prediction-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 6px;
            height: 100%;
            background: var(--gold-metallic);
            transform: scaleY(0);
            transition: var(--transition-smooth);
            border-radius: 0 3px 3px 0;
        }

        .prediction-item:hover {
            transform: translateY(-5px) translateX(5px);
            box-shadow: var(--shadow-strong), var(--glow-gold);
            border-color: var(--gold-bright);
        }

        .prediction-item:hover::before {
            transform: scaleY(1);
        }

        .prediction-item.top-result {
            border: 3px solid var(--gold-bright);
            box-shadow: var(--glow-gold);
        }

        .prediction-char {
            font-size: 3.2rem;
            font-weight: 700;
            color: var(--saffron-bright);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 85px;
            height: 85px;
            background: linear-gradient(135deg, var(--gold-glow), rgba(212, 175, 55, 0.15));
            border-radius: 20px;
            border: 3px solid var(--gold-bright);
            text-shadow: 0 3px 15px rgba(211, 84, 0, 0.4);
        }

        .prediction-details {
            flex: 1;
        }

        .prediction-confidence {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 0.6rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .prediction-name {
            font-size: 0.9rem;
            color: var(--text-secondary-light);
            font-family: 'Inter', monospace;
            opacity: 0.8;
            margin-bottom: 0.6rem;
        }

        .prediction-phonetic {
            font-size: 1.1rem;
            color: var(--teal-light);
            font-weight: 500;
            font-family: 'Inter', sans-serif;
        }

        .confidence-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 4px;
            margin-top: 1rem;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            background: var(--gold-metallic);
            border-radius: 4px;
            transition: width 1.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 15px var(--gold-glow);
        }

        /* Instructions Panel with Traditional Style */
        .instructions {
            background: var(--bg-glass-light);
            border-radius: 18px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 5px solid var(--teal-bright);
            border: 2px solid var(--glass-border);
        }

        .instructions-title {
            font-weight: 600;
            color: var(--teal-bright);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            font-size: 1.2rem;
        }

        .instructions-text {
            color: var(--text-secondary-light);
            line-height: 1.8;
            font-size: 0.95rem;
        }

        .instructions-text-en {
            font-family: 'Inter', sans-serif;
            margin-top: 0.7rem;
            opacity: 0.85;
            font-size: 0.85rem;
        }

        /* Empty State with Traditional Elements */
        .empty-state {
            text-align: center;
            color: var(--text-secondary-light);
            padding: 4rem 1rem;
        }

        .empty-state .lotus-icon {
            font-size: 5rem;
            color: var(--gold-bright);
            margin-bottom: 1.5rem;
            opacity: 0.8;
            animation: lotusGlow 3s ease-in-out infinite alternate;
        }

        @keyframes lotusGlow {
            from { text-shadow: 0 0 20px var(--gold-glow); }
            to { text-shadow: 0 0 30px var(--gold-glow), 0 0 40px var(--saffron-glow); }
        }

        /* Footer with Traditional Elements */
        .footer {
            text-align: center;
            padding: 1.5rem 0;
            border-top: 2px solid var(--glass-border);
            margin-top: 2rem;
            font-size: 0.85rem;
            color: var(--text-secondary-light);
            opacity: 0.8;
            position: relative;
        }

        .footer::before {
            content: '‚ùã ‚ùã ‚ùã';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-secondary);
            color: var(--gold-bright);
            padding: 0 1.5rem;
            font-size: 0.9rem;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .results-panel {
                position: relative;
                top: 0;
                max-height: none;
                order: 2;
            }

            .canvas-panel {
                order: 1;
            }
        }

        @media (max-width: 768px) {
            .app-container {
                padding: 0 1rem;
            }

            .header {
                padding: 1.5rem 0;
            }

            .canvas-panel,
            .results-panel {
                padding: 1.5rem;
                border-radius: 20px;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }

            .btn {
                padding: 1.2rem;
                justify-content: center;
            }

            #drawingCanvas {
                height: 350px;
            }

            .prediction-char {
                width: 70px;
                height: 70px;
                font-size: 2.8rem;
            }

            .prediction-confidence {
                font-size: 1.3rem;
            }
        }

        /* Animation Classes */
        .animate-in {
            animation: slideInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .bounce-in {
            animation: bounceIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        }

        @keyframes bounceIn {
            from {
                opacity: 0;
                transform: scale(0.3);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header with Traditional Sri Lankan Design -->
        <header class="header animate-in">
            <h1 class="app-title">‡∂Ö‡∂≠‡∑ä ‡∂Ö‡∂ö‡∑î‡∂ª‡∑î ‡∑Ñ‡∂≥‡∑î‡∂±‡∑è‡∂ú‡∑ê‡∂±‡∑ì‡∂∏</h1>
            <p class="app-title-en">Sinhala Handwriting Recognition</p>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Canvas Panel with Traditional Frame -->
            <section class="canvas-panel animate-in">
                <div class="canvas-header">
                    <h2 class="canvas-title">‡∂∏‡∑ô‡∑Ñ‡∑í ‡∂Ω‡∑í‡∂∫‡∂±‡∑ä‡∂±</h2>
                    <p class="canvas-title-en">Draw Your Character Here</p>
                </div>

                <div class="instructions">
                    <div class="instructions-title">
                        <i class="fas fa-info-circle"></i>
                        ‡∂ã‡∂¥‡∂Ø‡∑ô‡∑É‡∑ä
                    </div>
                    <div class="instructions-text">
                        ‡∂î‡∂∂‡∑ö ‡∂Ö‡∂ö‡∑ä‡∑Ç‡∂ª‡∂∫ ‡∂¥‡∑ê‡∑Ñ‡∑ê‡∂Ø‡∑í‡∂Ω‡∑í‡∑Ä ‡∂∏‡∑ô‡∑Ñ‡∑í ‡∂á‡∂≥ '‡∑Ñ‡∂≥‡∑î‡∂±‡∑è‡∂ú‡∂±‡∑ä‡∂±' ‡∂∂‡∑ú‡∂≠‡∑ä‡∂≠‡∂∏ ‡∂î‡∂∂‡∂±‡∑ä‡∂±
                        <div class="instructions-text-en">
                            Draw your character clearly and press the 'Recognize' button
                        </div>
                    </div>
                </div>

                <div class="canvas-container">
                    <canvas id="drawingCanvas" width="500" height="400"></canvas>
                    <div class="canvas-info">
                        <div><i class="fas fa-expand-arrows-alt"></i> 500√ó400 ‚Üí 80√ó80</div>
                        <div id="pressureInfo">‡∂∂‡∂Ω‡∂∫: ‡∂Ω‡∑ë‡∑É‡∑ä‡∂≠‡∑í‡∂∫‡∑í</div>
                    </div>
                </div>

                <div class="controls">
                    <button class="btn btn-primary" id="recognizeBtn">
                        <i class="fas fa-search"></i>
                        <div>
                            <div class="btn-text-si">‡∑Ñ‡∂≥‡∑î‡∂±‡∑è‡∂ú‡∂±‡∑ä‡∂±</div>
                            <div class="btn-text-en">Recognize</div>
                        </div>
                    </button>

                    <button class="btn btn-clear" id="clearBtn">
                        <i class="fas fa-eraser"></i>
                        <div>
                            <div class="btn-text-si">‡∂∏‡∂ö‡∂±‡∑ä‡∂±</div>
                            <div class="btn-text-en">Clear</div>
                        </div>
                    </button>

                    <button class="btn btn-secondary" id="undoBtn">
                        <i class="fas fa-undo"></i>
                        <div>
                            <div class="btn-text-si">‡∂Ü‡∂¥‡∑É‡∑î</div>
                            <div class="btn-text-en">Undo</div>
                        </div>
                    </button>
                </div>
            </section>

            <!-- Results Panel with Traditional Design -->
            <section class="results-panel animate-in">
                <div class="results-header">
                    <h3 class="results-title">‡∂¥‡∑ä‚Äç‡∂ª‡∂≠‡∑í‡∂µ‡∂Ω</h3>
                    <p class="results-title-en">Recognition Results</p>
                </div>

                <div id="statusMessage" class="status" style="display: none;"></div>

                <div class="predictions-container">
                    <div id="predictionsList">
                        <div class="empty-state">
                            <div class="lotus-icon">ü™∑</div>
                            <div style="color: var(--text-secondary-light); line-height: 1.8;">
                                <p style="font-weight: 500; margin-bottom: 0.8rem;">‡∂Ö‡∂ö‡∑ä‡∑Ç‡∂ª‡∂∫‡∂ö‡∑ä ‡∂á‡∂≥ ‡∑Ñ‡∂≥‡∑î‡∂±‡∑è‡∂ú‡∂±‡∑ä‡∂±</p>
                                <p style="font-family: 'Inter', sans-serif; font-size: 0.9rem; opacity: 0.8;">
                                    Draw a character and get AI predictions
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Session Statistics -->
                <div style="margin-top: 2.5rem; padding-top: 1.5rem; border-top: 2px solid var(--glass-border);">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; text-align: center;">
                        <div style="background: var(--bg-glass-light); padding: 1.5rem; border-radius: 16px; border: 1px solid var(--glass-border);">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--saffron-bright); margin-bottom: 0.5rem;" id="predictionCount">0</div>
                            <div style="font-size: 0.9rem; color: var(--text-secondary-light);">
                                <div>‡∂¥‡∑î‡∂ª‡∑ù‡∂ö‡∂Æ‡∂±</div>
                                <div style="font-family: 'Inter', sans-serif; opacity: 0.8; font-size: 0.8rem;">Predictions</div>
                            </div>
                        </div>
                        <div style="background: var(--bg-glass-light); padding: 1.5rem; border-radius: 16px; border: 1px solid var(--glass-border);">
                            <div style="font-size: 2rem; font-weight: 700; color: var(--teal-bright); margin-bottom: 0.5rem;" id="avgConfidence">-</div>
                            <div style="font-size: 0.9rem; color: var(--text-secondary-light);">
                                <div>‡∑É‡∑è‡∂∏‡∑è‡∂±‡∑ä‚Äç‡∂∫ ‡∑Ä‡∑í‡∑Å‡∑ä‡∑Ä‡∑è‡∑É‡∂∫</div>
                                <div style="font-family: 'Inter', sans-serif; opacity: 0.8; font-size: 0.8rem;">Avg. Confidence</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer with Traditional Elements -->
        <footer class="footer">
            <p>
                ‡∑Å‡∑ä‚Äç‡∂ª‡∑ì ‡∂Ω‡∂Ç‡∂ö‡∑è ‡∑É‡∂∏‡∑ä‡∂¥‡∑ä‚Äç‡∂ª‡∂Ø‡∑è‡∂∫‡∑í‡∂ö ‡∂ö‡∂Ω‡∑è ‡∑É‡∑Ñ ‡∂±‡∑Ä‡∑ì‡∂± AI ‡∂≠‡∑è‡∂ö‡∑ä‡∑Ç‡∂´‡∂∫ ‚Ä¢ Traditional Sri Lankan Art meets Modern AI
            </p>
        </footer>
    </div>

    <script>
        // Enhanced Canvas and drawing setup with traditional effects
        const canvas = document.getElementById('drawingCanvas');
        const ctx = canvas.getContext('2d');
        const recognizeBtn = document.getElementById('recognizeBtn');
        const clearBtn = document.getElementById('clearBtn');
        const undoBtn = document.getElementById('undoBtn');
        const statusMessage = document.getElementById('statusMessage');
        const predictionsList = document.getElementById('predictionsList');

        // Drawing state with traditional ink effects
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;
        let paths = [];
        let currentPath = [];

        // Statistics tracking
        let predictionCount = 0;
        let totalConfidence = 0;

        // Traditional brush settings
        const brushSettings = {
            size: 6,
            color: '#2C1E3A', // Traditional ink color
            minWidth: 2,
            maxWidth: 12
        };

        // Canvas setup with traditional paper texture
        function setupCanvas() {
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            clearCanvas();
        }

        // Clear canvas with traditional fade effect
        function clearCanvas() {
            ctx.fillStyle = '#FDF6E3';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            paths = [];
            currentPath = [];
        }

        // Enhanced drawing with traditional ink effects
        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;

            lastX = (e.clientX - rect.left) * scaleX;
            lastY = (e.clientY - rect.top) * scaleY;

            currentPath = [];
            currentPath.push({x: lastX, y: lastY, pressure: e.pressure || 0.5});
        }

        function draw(e) {
            if (!isDrawing) return;

            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            const currentX = (e.clientX - rect.left) * scaleX;
            const currentY = (e.clientY - rect.top) * scaleY;
            const pressure = e.pressure || 0.5;

            // Update pressure info in Sinhala
            const pressurePercent = (pressure * 100).toFixed(0);
            document.getElementById('pressureInfo').innerHTML =
                `<i class="fas fa-hand-pointer"></i> ‡∂∂‡∂Ω‡∂∫: ${pressurePercent}%`;

            // Traditional brush stroke with variable width
            const baseWidth = brushSettings.size * (0.5 + pressure * 0.5);
            const dynamicWidth = Math.max(brushSettings.minWidth,
                Math.min(brushSettings.maxWidth, baseWidth));

            // Create traditional ink stroke
            ctx.globalAlpha = 0.8 + pressure * 0.2;
            ctx.strokeStyle = brushSettings.color;
            ctx.lineWidth = dynamicWidth;
            ctx.shadowColor = 'rgba(44, 30, 58, 0.3)';
            ctx.shadowBlur = 2;

            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(currentX, currentY);
            ctx.stroke();

            currentPath.push({x: currentX, y: currentY, pressure: pressure});
            lastX = currentX;
            lastY = currentY;
        }

        function stopDrawing() {
            if (isDrawing) {
                paths.push([...currentPath]);
                currentPath = [];
                ctx.shadowBlur = 0;
            }
            isDrawing = false;
        }

        // Enhanced event listeners for drawing
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);

        // Enhanced touch events for tablets
        canvas.addEventListener('touchstart', function(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const pressure = e.touches[0].force || 0.5;
            const mouseEvent = new MouseEvent('mousedown', {
                clientX: touch.clientX,
                clientY: touch.clientY,
                pressure: pressure
            });
            canvas.dispatchEvent(mouseEvent);
        });

        canvas.addEventListener('touchmove', function(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const pressure = e.touches[0].force || 0.5;
            const mouseEvent = new MouseEvent('mousemove', {
                clientX: touch.clientX,
                clientY: touch.clientY,
                pressure: pressure
            });
            canvas.dispatchEvent(mouseEvent);
        });

        canvas.addEventListener('touchend', function(e) {
            e.preventDefault();
            const mouseEvent = new MouseEvent('mouseup', {});
            canvas.dispatchEvent(mouseEvent);
        });

        // Undo function with smooth animation
        function undoLastStroke() {
            if (paths.length > 0) {
                paths.pop();
                redrawCanvas();
            }
        }

        function redrawCanvas() {
            ctx.fillStyle = '#FDF6E3';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            for (const path of paths) {
                if (path.length > 0) {
                    ctx.beginPath();
                    ctx.moveTo(path[0].x, path[0].y);

                    for (let i = 1; i < path.length; i++) {
                        const point = path[i];
                        const baseWidth = brushSettings.size * (0.5 + point.pressure * 0.5);
                        ctx.lineWidth = Math.max(brushSettings.minWidth,
                            Math.min(brushSettings.maxWidth, baseWidth));
                        ctx.strokeStyle = brushSettings.color;
                        ctx.globalAlpha = 0.8 + point.pressure * 0.2;

                        ctx.lineTo(point.x, point.y);
                        ctx.stroke();
                        ctx.beginPath();
                        ctx.moveTo(point.x, point.y);
                    }
                }
            }
        }

        // Enhanced status messages with bilingual support
        function showStatus(messageSi, messageEn, type) {
            const spinner = type === 'loading' ? '<div class="loading-spinner"></div>' : '';
            statusMessage.innerHTML = `
                ${spinner}
                <div>
                    <div style="font-weight: 600;">${messageSi}</div>
                    <div style="font-family: 'Inter', sans-serif; font-size: 0.9rem; opacity: 0.9; margin-top: 3px;">${messageEn}</div>
                </div>
            `;
            statusMessage.className = `status ${type}`;
            statusMessage.style.display = 'block';

            if (type === 'success') {
                setTimeout(() => {
                    statusMessage.style.display = 'none';
                }, 4000);
            }
        }

        // Enhanced recognition function
        function recognizeCharacter() {
            const imageData = canvas.toDataURL('image/png');

            showStatus('‡∂Ö‡∂ö‡∑ä‡∑Ç‡∂ª‡∂∫ ‡∑Ä‡∑í‡∑Å‡∑ä‡∂Ω‡∑ö‡∑Ç‡∂´‡∂∫ ‡∂ö‡∂ª‡∂∏‡∑í‡∂±‡∑ä...', 'Analyzing character...', 'loading');
            recognizeBtn.disabled = true;

            // Real API call to the Flask backend
            fetch('/api/recognize', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    image: imageData,
                    top_k: 5
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success && data.predictions) {
                    displayPredictions(data.predictions);
                    updateStatistics(data.predictions);
                    showStatus('‡∂Ö‡∂ö‡∑ä‡∑Ç‡∂ª‡∂∫ ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∑Ä ‡∑Ñ‡∂≥‡∑î‡∂±‡∑è‡∂ú‡∂±‡∑ä‡∂±‡∑è ‡∂Ω‡∂Ø‡∑ì!',
                             'Character recognized successfully!', 'success');
                } else {
                    displayPredictions([]);
                    showStatus('‡∑Ñ‡∂≥‡∑î‡∂±‡∑è‡∂ú‡∑ê‡∂±‡∑ì‡∂∏ ‡∂Ö‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í',
                             'Recognition failed: ' + (data.message || 'Unknown error'), 'error');
                }
                recognizeBtn.disabled = false;
            })
            .catch(error => {
                console.error('Recognition error:', error);
                displayPredictions([]);
                showStatus('‡∑É‡∂∏‡∑ä‡∂∂‡∂±‡∑ä‡∂∞‡∂≠‡∑è ‡∂Ø‡∑ù‡∑Ç‡∂∫‡∂ö‡∑ä',
                         'Connection error: Could not reach AI model', 'error');
                recognizeBtn.disabled = false;
            });
        }

        // Enhanced prediction display with phonetic information
        function displayPredictions(predictions) {
            if (predictions.length === 0) {
                predictionsList.innerHTML = `
                    <div class="empty-state">
                        <div class="lotus-icon">‚ùå</div>
                        <div style="color: #E74C3C; line-height: 1.8;">
                            <p style="font-weight: 500; margin-bottom: 0.8rem;">‡∑Ä‡∑í‡∑Å‡∑ä‡∑Ä‡∑è‡∑É‡∂±‡∑ì‡∂∫ ‡∂¥‡∑î‡∂ª‡∑ù‡∂ö‡∂Æ‡∂± ‡∂±‡∑ú‡∂∏‡∑ê‡∂≠</p>
                            <p style="font-family: 'Inter', sans-serif; font-size: 0.9rem; opacity: 0.8;">
                                No confident predictions found. Try drawing more clearly.
                            </p>
                        </div>
                    </div>
                `;
                return;
            }

            // Phonetic mapping for common characters
            const phoneticMap = {
                '‡∂Ö': 'a', '‡∂Ü': 'ƒÅ', '‡∂á': '√¶', '‡∂à': '«£', '‡∂â': 'i', '‡∂ä': 'ƒ´', '‡∂å': 'u', '‡∂ç': '≈´',
                '‡∂ë': 'e', '‡∂í': 'ƒì', '‡∂î': 'o', '‡∂ï': '≈ç', '‡∂ö': 'ka', '‡∂ú': 'ga', '‡∂†': 'cha', '‡∂¢': 'ja',
                '‡∂ß': '·π≠a', '‡∂©': '·∏ça', '‡∂≠': 'ta', '‡∂Ø': 'da', '‡∂¥': 'pa', '‡∂∂': 'ba', '‡∂∏': 'ma', '‡∂∫': 'ya',
                '‡∂ª': 'ra', '‡∂Ω': 'la', '‡∑Ä': 'va', '‡∑É': 'sa', '‡∑Ñ': 'ha', '‡∂´': '·πáa', '‡∂±': 'na'
            };

            let html = '';
            predictions.forEach((pred, index) => {
                const phonetic = phoneticMap[pred.character] || pred.class_name;
                const isTop = index === 0;
                const confidence = pred.confidence_percent;

                html += `
                    <div class="prediction-item ${isTop ? 'top-result' : ''} bounce-in" style="animation-delay: ${index * 0.1}s">
                        <div class="prediction-char">${pred.character}</div>
                        <div class="prediction-details">
                            <div class="prediction-confidence">
                                ${confidence.toFixed(1)}%
                                ${isTop ? '<i class="fas fa-crown" style="color: var(--gold-bright); margin-left: 0.5rem;"></i>' : ''}
                            </div>
                            <div class="prediction-phonetic">${phonetic}</div>
                            <div class="prediction-name">${pred.class_name}</div>
                            <div class="confidence-bar">
                                <div class="confidence-fill" style="width: 0%; animation-delay: ${0.5 + index * 0.1}s"></div>
                            </div>
                        </div>
                    </div>
                `;
            });

            predictionsList.innerHTML = html;

            // Animate confidence bars
            setTimeout(() => {
                document.querySelectorAll('.confidence-fill').forEach((bar, index) => {
                    const width = predictions[index].confidence_percent;
                    bar.style.width = `${width}%`;
                });
            }, 200);
        }

        // Update session statistics with animations
        function updateStatistics(predictions) {
            if (predictions.length > 0) {
                predictionCount++;
                totalConfidence += predictions[0].confidence_percent;

                document.getElementById('predictionCount').textContent = predictionCount;
                document.getElementById('avgConfidence').textContent =
                    (totalConfidence / predictionCount).toFixed(1) + '%';
            }
        }

        // Event listeners
        clearBtn.addEventListener('click', clearCanvas);
        undoBtn.addEventListener('click', undoLastStroke);
        recognizeBtn.addEventListener('click', recognizeCharacter);

        // Initialize the application
        setupCanvas();

        console.log('üé® Traditional Sinhala Character Recognition Interface Loaded');
        console.log('üìù ‡∑É‡∂∏‡∑ä‡∂¥‡∑ä‚Äç‡∂ª‡∂Ø‡∑è‡∂∫‡∑í‡∂ö ‡∑Å‡∑ä‚Äç‡∂ª‡∑ì ‡∂Ω‡∑è‡∂Ç‡∂ö‡∑í‡∂ö ‡∂ö‡∂Ω‡∑è ‡∑É‡∑Ñ ‡∂±‡∑Ä‡∑ì‡∂± AI ‡∂≠‡∑è‡∂ö‡∑ä‡∑Ç‡∂´‡∂∫');
        console.log('‚ö° Ready for handwriting recognition with cultural authenticity');
    </script>
</body>
</html>
